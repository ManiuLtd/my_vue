webpackJsonp([34],{"9Vot":function(t,a){},"o+Rb":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("mvHQ"),n=e.n(s),r=e("//Fk"),i=e.n(r),o=e("Obkc"),l=e("7m8J"),c=e("RnxI"),d=e("irLX"),m=e("vjrR"),p=0,u=0,h={data:function(){return{data:{},address:"",formData:{partner_name:"",headImg:"",partnerImg:[],provinces:"",city:"",area:"",partner_lng:"",partner_lat:"",detail_address:"",partner_phone:""},fileHost:"",imageData:{a:[],g:[]},productLogo:[],productLogoExt:[],productImages:[],productImagesExt:[],responseLogoUrl:[],responseImages:[]}},created:function(){d.a.$on("getAddress",this.getAddressData)},methods:{submit1:function(){var t=this,a=new m.a;a.show(),this.$post(l.A,this.formData).then(function(e){200==e.code?(200==e.code&&(t.data=e.data),a.close()):new c.a(e.msg).show()}).then(function(t){a.close()})},submit:function(){var t=this.imageData,a=this;new i.a(function(e){if(console.log(t.a.length),t.a){var s=!1;for(var n in t.a)if(0==t.a[n].id){s=!0;break}s||e(t.a);var r=function(s){0==t.a[s].id&&a.$postImg("http://47.94.152.208:12345/file/upload_.html",{ext:t.a[s].ext,content:t.a[s].pd_url}).then(function(a){t.a[s].pd_url=a.result.url,t.a[s].id=-100,console.log(s),t.a.length-1==s&&(console.log("end"),e(t.a))})};for(var i in t.a)r(i)}else e(t.a)}).then(function(e){return new i.a(function(s,n){if(t.g){var r=!1;for(var i in t.g)if(0==t.g[i].id){r=!0;break}r||s({a:e,g:t.g});var o=function(n){0==t.g[n].id&&a.$postImg("http://47.94.152.208:12345/file/upload_.html",{ext:t.g[n].ext,content:t.g[n].pd_url}).then(function(a){t.g[n].pd_url=a.result.url,t.g[n].id=-100,t.g.length-1==n&&s({a:e,g:t.g})})};for(var l in t.g)o(l)}else s({a:e,g:t.g})})}).then(function(t){var e=JSON.parse(n()(t)),s=new m.a;a.formData.headImg=[],a.formData.partnerImg=[],a.formData.headImg=e.a[0].pd_url,e.g.forEach(function(t){a.formData.partnerImg.push(t.pd_url)}),s.show(),a.$post(l.A,a.formData).then(function(t){200==t.code?(200==t.code&&new c.a(t.msg).show(),s.close()):new c.a(t.msg).show()}).then(function(t){s.close()})})},getAddressData:function(t){this.address=t.name,this.formData.provinces=t.provinces,this.formData.city=t.city,this.formData.area=t.area,console.log(t)},getData:function(){var t=this,a=new m.a;a.show(),this.$get(l.A).then(function(e){200==e.code?(200==e.code&&(t.data=e.data,t.formData.partner_name=t.data.partner.partnerName,t.formData.provinces=t.data.partner.province,t.formData.city=t.data.partner.city,t.formData.area=t.data.partner.county,t.formData.partner_lng=t.data.partner.partnerLng,t.formData.partner_lat=t.data.partner.partnerLat,t.formData.detail_address=t.data.partner.partnerDetailAddress,t.address=t.data.partner.partner_address,t.formData.partner_phone=t.data.partner.partnerPhone,t.data.partner_daturm.b&&(t.imageData.a=t.data.partner_daturm.b),t.data.partner_daturm.c&&(t.imageData.g=t.data.partner_daturm.c)),a.close()):new c.a(e.msg).show()}).then(function(t){a.close()})},onProductLogoRead:function(t){var a=t.content,e=t.file.name,s=e.substring(e.lastIndexOf(".")+1).toLowerCase();this.imageData.a.length<1?this.imageData.a.push({ext:s,pd_url:a,id:0}):(this.imageData.a.pop(),this.imageData.a.push({ext:s,pd_url:a,id:0}))},onProductOtherRead:function(t){if(this.imageData.g.length<3){var a=t.content,e=t.file.name,s=e.substring(e.lastIndexOf(".")+1).toLowerCase();this.imageData.g.push({ext:s,pd_url:a,id:0})}else new c.a("店铺图片只能添加三张").show()},deleteLogoImage:function(t){this.imageData.a.splice(t,1)},deleteOtherImage:function(t){this.imageData.g.splice(t,1)},uploadImg:function(){0!=this.verification()&&this.submit()},postLogoImage:function(t){var a=this,e=new m.a;e.show(),this.$postImg("http://47.94.152.208:12345/file/upload_.html",{ext:t,content:this.productLogo[p]}).then(function(t){a.responseLogoUrl.push(t.result.url),p<a.productLogo.length?(p+=1,a.postLogoImage(a.productLogoExt[person_index])):a.productImages&&a.productImages.length>0?a.postOtherImage(a.productImagesExt[0]):a.saveProduct(),e.close()}).then(function(t){e.close()})},postOtherImage:function(t){var a=this,e=new m.a;e.show(),this.$postImg("http://47.94.152.208:12345/file/upload_.html",{ext:t,content:this.productImages[u]}).then(function(t){a.responseImages.push(t.result.url),u<a.productImages.length?(u+=1,a.postOtherImage(a.productImagesExt[u])):a.saveProduct(),e.close()}).then(function(t){e.close()})},verification:function(){return this.formData.partner_name?0==this.imageData.a.length?(new c.a("请添加店铺logo").show(),!1):0==this.imageData.g.length?(new c.a("请添加店铺图片").show(),!1):this.formData.provinces?this.formData.detail_address?this.formData.partner_phone?void 0:(new c.a("请添加商家电话").show(),!1):(new c.a("请添加详细地址").show(),!1):(new c.a("请添加店铺地址").show(),!1):(new c.a("请输入店铺名称").show(),!1)}},mounted:function(){var t=window.screen.availHeight,a=document.getElementsByClassName("common_header")[0].offsetHeight;document.getElementsByClassName("shop_create_content")[0].style.minHeight=t-a+"px",document.getElementsByClassName("shop_create_content")[0].style.backgroundColor="#eee",this.fileHost="http://ysfq-test.oss-cn-beijing.aliyuncs.com/",this.getData()},components:{TopHeader:o.a}},g={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"shop_create_content"},[s("top-header",{attrs:{"title-txt":"基本信息"}}),t._v(" "),s("form",{staticClass:"content",attrs:{id:"shopMsg",onsubmit:"return false"}},[s("div",{staticClass:"input_content"},[s("ul",{staticClass:"input_box"},[s("li",{staticClass:"input_div"},[t._m(0),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.partner_name,expression:"formData.partner_name",modifiers:{trim:!0}}],attrs:{type:"text",maxlength:"20",name:"partner_name",placeholder:"输入店铺名称(20字以内)"},domProps:{value:t.formData.partner_name},on:{input:function(a){a.target.composing||t.$set(t.formData,"partner_name",a.target.value.trim())},blur:function(a){t.$forceUpdate()}}})]),t._v(" "),s("li",{staticClass:"input_img"},[t._m(1),t._v(" "),s("div",{staticClass:"img_up"},[s("van-uploader",{attrs:{"after-read":t.onProductLogoRead,accept:"image/*",multiple:""}},[s("van-icon",{attrs:{name:"photograph"}})],1)],1),t._v(" "),s("input",{attrs:{type:"hidden",id:"headImg",name:"headImg",value:""}}),t._v(" "),s("p",{staticClass:"tips"},[t._v("图片上传要求：单张图片小于10M，此处只能添加一张图片")])]),t._v(" "),s("div",{staticClass:"img_select_box"},t._l(t.imageData.a,function(a,n){return s("div",{staticClass:"img_box"},[s("img",{staticClass:"img_delete",attrs:{src:e("UQDv")},on:{click:function(a){t.deleteLogoImage(n)}}}),t._v(" "),s("img",{staticClass:"img_select",attrs:{src:a.id?t.fileHost+a.pd_url:a.pd_url}})])})),t._v(" "),s("li",{staticClass:"input_img"},[t._m(2),t._v(" "),s("div",{staticClass:"img_up"},[s("van-uploader",{attrs:{"after-read":t.onProductOtherRead,accept:"image/*",multiple:""}},[s("van-icon",{attrs:{name:"photograph"}})],1)],1),t._v(" "),s("input",{attrs:{type:"hidden",name:"partnerImg[]",value:""}}),t._v(" "),s("p",{staticClass:"tips"},[t._v("图片上传要求：单张图片小于10M此处最多只能添加三张图片。")])]),t._v(" "),s("div",{staticClass:"img_select_box"},t._l(t.imageData.g,function(a,n){return s("div",{staticClass:"img_box"},[s("img",{staticClass:"img_delete",attrs:{src:e("UQDv")},on:{click:function(a){t.deleteOtherImage(n)}}}),t._v(" "),s("img",{staticClass:"img_select",attrs:{src:a.id?t.fileHost+a.pd_url:a.pd_url}})])})),t._v(" "),s("li",{staticClass:"input_div"},[t._m(3),t._v(" "),s("input",{attrs:{type:"hidden",name:"provinces",placeholder:"",value:""}}),t._v(" "),s("input",{attrs:{type:"hidden",name:"city",placeholder:"",value:""}}),t._v(" "),s("input",{attrs:{type:"hidden",name:"area",placeholder:"",value:""}}),t._v(" "),s("router-link",{attrs:{to:"/address"}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.address,expression:"address",modifiers:{trim:!0}}],staticClass:"icon_input",attrs:{type:"text",placeholder:"请选择",readonly:"readonly"},domProps:{value:t.address},on:{input:function(a){a.target.composing||(t.address=a.target.value.trim())},blur:function(a){t.$forceUpdate()}}}),t._v(" "),s("i",{staticClass:"icon_arrow"})])],1),t._v(" "),s("li",{staticClass:"input_div"},[t._m(4),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.detail_address,expression:"formData.detail_address",modifiers:{trim:!0}}],attrs:{type:"text",name:"detail_address",placeholder:"输入详细地址",value:""},domProps:{value:t.formData.detail_address},on:{input:function(a){a.target.composing||t.$set(t.formData,"detail_address",a.target.value.trim())},blur:function(a){t.$forceUpdate()}}})]),t._v(" "),s("li",{staticClass:"input_div"},[t._m(5),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.partner_phone,expression:"formData.partner_phone",modifiers:{trim:!0}}],attrs:{type:"text",name:"partner_phone",placeholder:"输入商家电话",value:""},domProps:{value:t.formData.partner_phone},on:{input:function(a){a.target.composing||t.$set(t.formData,"partner_phone",a.target.value.trim())},blur:function(a){t.$forceUpdate()}}})])])]),t._v(" "),t._m(6),t._v(" "),s("span",{staticClass:"preserve_btn",on:{click:t.uploadImg}},[t._v("保存")])])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("label",[a("span",{staticClass:"must"},[this._v("*")]),this._v("店铺名称")])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",[a("span",{staticClass:"must"},[this._v("*")]),this._v("店铺LOGO")])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",[a("span",{staticClass:"must"},[this._v("*")]),this._v("店铺图片")])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",[a("span",{staticClass:"must"},[this._v("*")]),this._v("店铺地址")])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",[a("span",{staticClass:"must"},[this._v("*")]),this._v("详细地址")])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",[a("span",{staticClass:"must"},[this._v("*")]),this._v("商家电话")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",{staticClass:"must_title"},[a("span",{staticClass:"must"},[this._v("*")]),this._v("为必填项")])}]};var _=e("VU/8")(h,g,!1,function(t){e("9Vot")},"data-v-f4da0e52",null);a.default=_.exports}});
//# sourceMappingURL=34.6af9096a4ce64cdef3db.js.map