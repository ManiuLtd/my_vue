webpackJsonp([42],{M8a2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),n=a.n(s),i=a("//Fk"),o=a.n(i),r=a("Obkc"),l=a("7m8J"),c=a("RnxI"),u=(a("NC6I"),a("aBzk"),a("ERmT"),a("mtWM"),{data:function(){return{personImgNameEtx:[],otherImageNameEtx:[],person_selectImages:[],other_selectImages:[],perosnUploadImages:[],otherUploadImages:[],fileHost:"http://ysfq-test.oss-cn-beijing.aliyuncs.com/",formData:{a:[],g:[]}}},methods:{submit:function(){var t=this.formData,e=this;new o.a(function(a){if(console.log(t.a.length),t.a){var s=!1;for(var n in t.a)if(0==t.a[n].id){s=!0;break}s||a(t.a);var i=function(s){0==t.a[s].id&&e.$postImg("http://47.94.152.208:12345/file/upload_.html",{ext:t.a[s].ext,content:t.a[s].pd_url}).then(function(e){t.a[s].pd_url=e.result.url,t.a[s].id=-100,console.log(s),t.a.length-1==s&&(console.log("end"),a(t.a))})};for(var o in t.a)i(o)}else a(t.a)}).then(function(a){return new o.a(function(s,n){if(t.g){var i=!1;for(var o in t.g)if(0==t.g[o].id){i=!0;break}i||s({a:a,g:t.g});var r=function(n){0==t.g[n].id&&e.$postImg("http://47.94.152.208:12345/file/upload_.html",{ext:t.g[n].ext,content:t.g[n].pd_url}).then(function(e){t.g[n].pd_url=e.result.url,t.g[n].id=-100,t.g.length-1==n&&s({a:a,g:t.g})})};for(var l in t.g)r(l)}else s({a:a,g:t.g})})}).then(function(t){var a=JSON.parse(n()(t));console.log(a);var s={idUpload:[],otherUpload:[]};a.a.forEach(function(t){s.idUpload.push(t.pd_url)}),a.g.forEach(function(t){s.otherUpload.push(t.pd_url)}),console.log(s),e.$post(l.t,s).then(function(t){console.log(t),t.code,new c.a(t.msg).show()}),console.log(s)})},initImages:function(){var t=this;this.$get(l.t).then(function(e){200==e.code?200==e.code&&(e.data.g&&(t.formData.g=e.data.g),e.data.a&&(t.formData.a=e.data.a)):new c.a(e.msg).show()})},upload:function(){this.postPersonImage(this.personImgNameEtx[0])},onPersonRead:function(t){var e=t.content;this.person_selectImages.push(e);var a=t.file.name,s=a.substring(a.lastIndexOf(".")+1).toLowerCase();this.formData.a.push({pd_url:e,id:0,ext:s,pd_type:"a"})},onOtherRead:function(t){var e=t.content;this.other_selectImages.push(e);var a=t.file.name,s=a.substring(a.lastIndexOf(".")+1).toLowerCase();this.formData.g.push({pd_url:e,id:0,ext:s,pd_type:"a"})},deleteImage:function(t,e){this.formData[e].splice(t,1)}},mounted:function(){var t=window.screen.availHeight,e=document.getElementsByClassName("common_header")[0].offsetHeight;document.getElementsByClassName("shop_create_content")[0].style.minHeight=t-e+"px",document.getElementsByClassName("shop_create_content")[0].style.backgroundColor="#eee",this.initImages()},components:{TopHeader:r.a}}),m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop_create_content"},[s("top-header",{attrs:{"title-txt":"上传资料"}}),t._v(" "),s("form",{staticClass:"content",attrs:{onsubmit:"return false"}},[s("div",{staticClass:"input_content"},[s("ul",{staticClass:"input_box"},[s("li",{staticClass:"input_img"},[t._m(0),t._v(" "),s("div",{staticClass:"img_up"},[s("van-uploader",{attrs:{"after-read":t.onPersonRead,accept:"image/*",multiple:""}},[s("van-icon",{attrs:{name:"photograph"}})],1)],1),t._v(" "),s("p",{staticClass:"tips"},[t._v("请注意证件照片上的文字清晰可见,限制3张。")])]),t._v(" "),s("div",{staticClass:"img_select_box"},t._l(t.formData.a,function(e,n){return s("div",{staticClass:"img_box"},[s("img",{staticClass:"img_delete",attrs:{src:a("UQDv")},on:{click:function(e){t.deleteImage(n,"a")}}}),t._v(" "),s("img",{staticClass:"img_select",attrs:{src:e.id?t.fileHost+e.pd_url:e.pd_url}})])})),t._v(" "),s("li",{staticClass:"input_img"},[s("label",[t._v("其他资料上传")]),t._v(" "),s("div",{staticClass:"img_up"},[s("van-uploader",{attrs:{"after-read":t.onOtherRead,accept:"image/*",multiple:""}},[s("van-icon",{attrs:{name:"photograph"}})],1)],1),t._v(" "),s("p",{staticClass:"tips"},[t._v("请注意证件照片上的文字清晰可见,限制3张。")])]),t._v(" "),s("div",{staticClass:"img_select_box"},t._l(t.formData.g,function(e,n){return s("div",{staticClass:"img_box"},[s("img",{staticClass:"img_delete",attrs:{src:a("UQDv")},on:{click:function(e){t.deleteImage(n,"g")}}}),t._v(" "),s("img",{staticClass:"img_select",attrs:{src:e.id?t.fileHost+e.pd_url:e.pd_url}})])}))])]),t._v(" "),t._m(1),t._v(" "),s("span",{staticClass:"preserve_btn",on:{click:t.submit}},[t._v("保存")])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("label",[e("span",{staticClass:"must"},[this._v("*")]),this._v("证件上传")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"must_title"},[e("span",{staticClass:"must"},[this._v("*")]),this._v("为必填项，请确保照片资料真实有效。")])}]};var g=a("VU/8")(u,m,!1,function(t){a("i3fK")},"data-v-802cfa98",null);e.default=g.exports},i3fK:function(t,e){}});
//# sourceMappingURL=42.5075e9878e2b7dd9ec0e.js.map